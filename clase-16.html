<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clase 16: DataBinding y XML - IF0100 POO II</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            background-color: #1e40af;
            color: white;
            padding: 20px;
            text-align: center;
        }
        nav {
            background-color: #333;
            color: white;
            padding: 10px;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        nav ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
        }
        nav li {
            margin: 0 15px;
        }
        nav a {
            color: white;
            text-decoration: none;
        }
        main {
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        section {
            margin-bottom: 40px;
        }
        h1, h2, h3 {
            color: #1e40af;
        }
        figure {
            text-align: center;
            margin: 20px 0;
        }
        figure img {
            max-width: 100%;
            height: auto;
        }
        figcaption {
            font-style: italic;
            color: #666;
        }
        pre {
            background-color: #f8f9fa;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
        }
        code {
            font-family: 'Courier New', monospace;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #1e40af;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .objectives ul {
            list-style-type: disc;
            margin-left: 20px;
        }
        .prerequisites {
            background-color: #e7f3ff;
            padding: 15px;
            border-left: 5px solid #1e40af;
        }
        .note {
            background: #f0f4ff;
            border-left: 4px solid #3b82f6;
            padding: 10px 12px;
            border-radius: 8px;
            color: #52606d;
        }
        /* Syntax highlighting para C# */
        .token-keyword { color: #c792ea; font-weight: 600; }
        .token-type { color: #ffcb6b; }
        .token-string { color: #c3e88d; }
        .token-comment { color: #546e7a; font-style: italic; }
        .token-number { color: #f78c6c; }
        .token-operator { color: #89ddff; }
        /* Accessibility */
        abbr[title] { text-decoration: underline dotted; cursor: help; }
        /* Print styles */
        @media print {
            header, nav, footer { background: white !important; color: black !important; }
            a[href]:after { content: " (" attr(href) ")"; font-size: 0.8em; }
            pre, code { white-space: pre-wrap; }
        }

        /* BLOQUES DE C√ìDIGO MEJORADOS */
        .code-block {
            background: #1e1e2e;
            border-radius: 12px;
            margin: 16px 0;
            overflow: hidden;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            border: 1px solid #313244;
        }

        .code-header {
            background: linear-gradient(90deg, #313244 0%, #45475a 100%);
            padding: 10px 16px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #45475a;
        }

        .code-dots {
            display: flex;
            gap: 6px;
        }

        .code-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .code-dot.red { background: #f38ba8; }
        .code-dot.yellow { background: #f9e2af; }
        .code-dot.green { background: #a6e3a1; }

        .code-title {
            color: #cdd6f4;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: auto;
            font-family: 'Cascadia Code', Consolas, monospace;
        }

        .code-content {
            display: flex;
            background: #1e1e2e;
        }

        .line-numbers {
            background: #181825;
            color: #6c7086;
            padding: 12px 10px;
            text-align: right;
            font-family: 'Cascadia Code', Consolas, monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            user-select: none;
            border-right: 1px solid #313244;
        }

        .code-block pre {
            background: transparent;
            margin: 0;
            padding: 12px 16px;
            flex: 1;
            overflow-x: auto;
        }

        .code-block pre code {
            color: #cdd6f4;
            font-size: 0.95rem;
            line-height: 1.5;
            display: block;
        }

        /* Syntax highlighting mejorado - Catppuccin Mocha theme */
        .code-block .token-keyword { color: #cba6f7; font-weight: 600; } /* purple */
        .code-block .token-type { color: #f9e2af; } /* yellow */
        .code-block .token-string { color: #a6e3a1; } /* green */
        .code-block .token-comment { color: #6c7086; font-style: italic; } /* gray */
        .code-block .token-number { color: #fab387; } /* peach */
        .code-block .token-operator { color: #89dceb; } /* cyan */
        .code-block .token-method { color: #89b4fa; } /* blue */
        .code-block .token-class { color: #f9e2af; font-weight: 600; }
        .code-block .token-property { color: #b4befe; } /* lavender */
        .code-block .token-namespace { color: #f38ba8; } /* pink */

        /* C√≥digo inline */
        p code, li code {
            background: #313244;
            color: #cdd6f4;
            padding: 2px 8px;
            border-radius: 6px;
            font-size: 0.9em;
            border: 1px solid #45475a;
        }

        /* Tablas de c√≥digo */
        .code-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 16px;
            margin: 16px 0;
        }

        .code-comparison .code-block {
            margin: 0;
        }

        .code-label {
            font-size: 0.8rem;
            color: #6c7086;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
        }
    </style>
    .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: #1e40af;
        color: #fff;
        padding: 8px 16px;
        text-decoration: none;
        z-index: 100;
        transition: top 0.3s;
    }
    .skip-link:focus {
        top: 0;
    }
</head>
<body>
    <a href="#main" class="skip-link">Saltar al contenido</a>
    <header>
        <h1>IF0100 - Lenguaje de Programaci√≥n OO II</h1>
        <h2>Unidad 5: Arquitectura de Datos Desconectados</h2>
        <h3>Clase 16: DataBinding y XML</h3>
        <p><strong>Duraci√≥n:</strong> 75 minutos | <strong>Fecha:</strong> 2026-05-25</p>
    </header>

    <nav>
        <ul>
            <li><a href="#teoria">Teor√≠a</a></li>
            <li><a href="#ejemplos">Ejemplos</a></li>
            <li><a href="#practica">Pr√°ctica / Laboratorio</a></li>
            <li><a href="#ejercicios">Ejercicios</a></li>
            <li><a href="#referencias">Referencias</a></li>
        </ul>
    </nav>

    <main id="main">
        <section id="teoria">
        <section id="objetivos">
            <h2>üéØ Objetivos de Aprendizaje</h2>
            <div class="objectives">
                <p>Al finalizar esta clase, el estudiante ser√° capaz de:</p>
                <ul>
                    <li>Implementar data binding bidireccional en Windows Forms</li>
                    <li>Utilizar archivos XML como fuente de datos</li>
                    <li>Exportar e importar datos usando DataSet y XML</li>
                    <li>Aplicar BindingSource para sincronizaci√≥n de controles</li>
                </ul>
            </div>
        </section>

        <section id="prerrequisitos">
            <h2>üìã Prerrequisitos</h2>
            <div class="prerequisites">
                <p>Para comprender esta clase, se requiere:</p>
                <ul>
                    <li>Conocimientos b√°sicos de Windows Forms</li>
                    <li>Entendimiento de DataSet y DataAdapter</li>
                    <li>Familiaridad con XML b√°sico</li>
                    <li>Conceptos de ADO.NET</li>
                </ul>
            </div>
        </section>

        <section id="teoria-content">
            <h2>üìä Teor√≠a: DataBinding y XML</h2>

            <div class="prerequisites" style="background-color: #fff3cd; border-left-color: #ffc107;">
                <strong>¬øPor qu√© DataBinding?</strong>
                <ul>
                    <li><strong>Productividad:</strong> Menos c√≥digo manual para sincronizar UI con datos</li>
                    <li><strong>Consistencia:</strong> Todos los controles reflejan los mismos datos autom√°ticamente</li>
                    <li><strong>Navegaci√≥n:</strong> Implementaci√≥n simplificada de anterior/siguiente/primero/√∫ltimo</li>
                    <li><strong>Validaci√≥n:</strong> Las reglas de validaci√≥n se aplican en un solo lugar</li>
                </ul>
            </div>

            <h3>¬øQu√© es Data Binding?</h3>
            <p><strong><abbr title="Mecanismo que enlaza autom√°ticamente controles visuales (TextBox, DataGridView, ComboBox) con fuentes de datos (DataTable, List, objetos), sincronizando cambios bidireccionalmente">Data Binding</abbr></strong> = Enlace autom√°tico entre controles visuales y fuentes de datos que sincroniza cambios bidireccionalmente sin c√≥digo manual.</p>
            <p>Enlazar autom√°ticamente controles visuales (TextBox, DataGridView, ComboBox) con fuentes de datos (DataTable, List, etc.).</p>

            <h3>BindingSource (Recomendado)</h3>
            <p><strong><abbr title="Componente de Windows Forms que act√∫a como intermediario entre la fuente de datos y los controles UI, proporcionando navegaci√≥n, filtrado, ordenamiento y notificaci√≥n de cambios">BindingSource</abbr></strong> = Componente intermediario entre datos y controles UI.</p>

            <h4>Ventajas de BindingSource:</h4>
            <ul>
                <li>‚úÖ Sincronizaci√≥n autom√°tica entre controles</li>
                <li>‚úÖ Navegaci√≥n entre registros (MoveNext, MovePrevious)</li>
                <li>‚úÖ Filtrado y ordenamiento</li>
                <li>‚úÖ Notificaci√≥n de cambios</li>
            </ul>

            <h3>Windows Forms y DataGridView</h3>
            <p><strong><abbr title="Framework de UI para aplicaciones de escritorio en .NET con controles visuales pre-construidos como TextBox, Button, DataGridView">Windows Forms</abbr></strong> = Framework de UI para aplicaciones de escritorio en .NET.</p>
            <p><strong><abbr title="Control de Windows Forms que muestra datos en formato de tabla (filas y columnas) con soporte para selecci√≥n, edici√≥n, ordenamiento y paginaci√≥n">DataGridView</abbr></strong> = Control de tabla para mostrar y editar datos.</p>

            <h3>DataSet y XML</h3>
            <p><strong><abbr title="Lenguaje de Marcado Extensible, formato de texto para almacenar y transportar datos de manera estructurada y legible por humanos">XML</abbr></strong> = Formato de texto para almacenar y transportar datos estructurados.</p>
            <p>Exportar e importar datos usando formato XML.</p>

            <h4>Aplicaciones pr√°cticas:</h4>
            <ul>
                <li>‚úÖ Backup de datos</li>
                <li>‚úÖ Intercambio entre aplicaciones</li>
                <li>‚úÖ Configuraci√≥n compleja</li>
                <li>‚úÖ Datos temporales offline</li>
            </ul>

            <div class="prerequisites" style="background-color: #fff3cd; border-left-color: #ffc107;">
                <strong>Errores Comunes con DataBinding</strong>
                <ul>
                    <li><strong>No usar BindingSource:</strong> Enlazar directamente a DataTable causa problemas de sincronizaci√≥n entre controles</li>
                    <li><strong>Olvidar EndEdit():</strong> Los cambios en TextBox no se aplican al DataRow hasta llamar EndEdit()</li>
                    <li><strong>DataSourceUpdateMode incorrecto:</strong> OnPropertyChanged actualiza en cada tecla, OnValidation solo al perder foco</li>
                    <li><strong>Conflicto de concurrencia:</strong> DBConcurrencyException ocurre cuando m√∫ltiples usuarios editan el mismo registro</li>
                </ul>
            </div>

            <h3>DataBinding con ADO.NET</h3>
            <p>Integraci√≥n completa con base de datos usando BindingSource y SqlDataAdapter.</p>

            <div class="prerequisites" style="background-color: #d4edda; border-left-color: #28a745;">
                <strong>Mini-Chequeo: DataBinding y XML</strong>
                <ul>
                    <li>¬øPor qu√© usar BindingSource en lugar de enlazar directamente?</li>
                    <li>¬øCu√°l es la diferencia entre DataSourceUpdateMode.OnPropertyChanged y OnValidation?</li>
                    <li>¬øPara qu√© sirve DataSet.WriteXml() vs WriteXmlSchema()?</li>
                    <li>¬øC√≥mo manejar DBConcurrencyException?</li>
                </ul>
            </div>
        </section>
        </section>

        <section id="ejemplos">
            <h2>üíª Ejemplos Pr√°cticos</h2>
            
            <h3>Ejemplo completo de DataBinding con Windows Forms</h3>
            <pre><code>using System.Windows.Forms;

public class FormEstudiantes : Form
{
    private DataTable dtEstudiantes;
    private BindingSource bindingSource;
    private DataGridView dgvEstudiantes;
    private TextBox txtNombre, txtApellido, txtEmail;
    private Button btnGuardar, btnEliminar, btnNuevo;

    public FormEstudiantes()
    {
        InicializarComponentes();
        CargarDatos();
    }

    private void InicializarComponentes()
    {
        // Crear controles
        dgvEstudiantes = new DataGridView
        {
            Dock = DockStyle.Top,
            Height = 300,
            SelectionMode = DataGridViewSelectionMode.FullRowSelect
        };

        txtNombre = new TextBox { Location = new Point(100, 320), Width = 200 };
        txtApellido = new TextBox { Location = new Point(100, 350), Width = 200 };
        txtEmail = new TextBox { Location = new Point(100, 380), Width = 200 };

        btnNuevo = new Button
        {
            Text = "Nuevo",
            Location = new Point(100, 420),
            Width = 80
        };
        btnNuevo.Click += BtnNuevo_Click;

        btnGuardar = new Button
        {
            Text = "Guardar",
            Location = new Point(190, 420),
            Width = 80
        };
        btnGuardar.Click += BtnGuardar_Click;

        btnEliminar = new Button
        {
            Text = "Eliminar",
            Location = new Point(280, 420),
            Width = 80
        };
        btnEliminar.Click += BtnEliminar_Click;

        // Agregar labels
        Controls.Add(new Label { Text = "Nombre:", Location = new Point(20, 323) });
        Controls.Add(new Label { Text = "Apellido:", Location = new Point(20, 353) });
        Controls.Add(new Label { Text = "Email:", Location = new Point(20, 383) });

        // Agregar controles al form
        Controls.Add(dgvEstudiantes);
        Controls.Add(txtNombre);
        Controls.Add(txtApellido);
        Controls.Add(txtEmail);
        Controls.Add(btnNuevo);
        Controls.Add(btnGuardar);
        Controls.Add(btnEliminar);

        Text = "Gesti√≥n de Estudiantes";
        Width = 600;
        Height = 500;
    }

    private void CargarDatos()
    {
        // Crear DataTable (en producci√≥n vendr√≠a de BD)
        dtEstudiantes = new DataTable("Estudiantes");
        dtEstudiantes.Columns.Add("Id", typeof(int));
        dtEstudiantes.Columns.Add("Nombre", typeof(string));
        dtEstudiantes.Columns.Add("Apellido", typeof(string));
        dtEstudiantes.Columns.Add("Email", typeof(string));
        dtEstudiantes.PrimaryKey = new DataColumn[] { dtEstudiantes.Columns["Id"] };

        // Datos de ejemplo
        dtEstudiantes.Rows.Add(1, "Juan", "P√©rez", "juan@unaula.edu.co");
        dtEstudiantes.Rows.Add(2, "Mar√≠a", "Garc√≠a", "maria@unaula.edu.co");
        dtEstudiantes.Rows.Add(3, "Carlos", "L√≥pez", "carlos@unaula.edu.co");

        // Configurar BindingSource
        bindingSource = new BindingSource();
        bindingSource.DataSource = dtEstudiantes;

        // Enlazar DataGridView
        dgvEstudiantes.DataSource = bindingSource;

        // Enlazar TextBoxes individuales
        txtNombre.DataBindings.Add("Text", bindingSource, "Nombre", true);
        txtApellido.DataBindings.Add("Text", bindingSource, "Apellido", true);
        txtEmail.DataBindings.Add("Text", bindingSource, "Email", true);
    }

    private void BtnNuevo_Click(object sender, EventArgs e)
    {
        bindingSource.AddNew();
        txtNombre.Focus();
    }

    private void BtnGuardar_Click(object sender, EventArgs e)
    {
        bindingSource.EndEdit();
        dtEstudiantes.AcceptChanges();
        MessageBox.Show("Cambios guardados", "√âxito");
    }

    private void BtnEliminar_Click(object sender, EventArgs e)
    {
        if (bindingSource.Current != null)
        {
            if (MessageBox.Show("¬øEliminar registro?", "Confirmar",
                MessageBoxButtons.YesNo) == DialogResult.Yes)
            {
                bindingSource.RemoveCurrent();
            }
        }
    }
}</code></pre>

            <h3>Exportar e Importar DataSet a XML</h3>
            <p><strong><abbr title="Enumeraci√≥n que controla qu√© se exporta: WriteSchema (datos + esquema XSD), IgnoreSchema (solo datos), DiffGram (datos + versi√≥n original + cambios)">XmlWriteMode</abbr></strong> = Modo de exportaci√≥n XML.</p>
            <p><strong><abbr title="Enumeraci√≥n que controla c√≥mo se lee XML: ReadSchema (lee esquema incrustado), IgnoreSchema (infiere desde datos), InferSchema (crea esquema desde datos), DiffGram (lee con tracking de cambios)">XmlReadMode</abbr></strong> = Modo de importaci√≥n XML.</p>
            <pre><code>public class DataSetXmlHelper
{
    // Exportar solo datos
    public void ExportarDatos(DataSet ds, string archivo)
    {
        ds.WriteXml(archivo, XmlWriteMode.WriteSchema);
        Console.WriteLine($"Datos exportados a {archivo}");
    }

    // Exportar solo esquema (estructura)
    public void ExportarEsquema(DataSet ds, string archivo)
    {
        ds.WriteXmlSchema(archivo);
        Console.WriteLine($"Esquema exportado a {archivo}");
    }

    // Exportar datos + esquema en archivos separados
    public void ExportarCompleto(DataSet ds, string archivoBase)
    {
        ds.WriteXml($"{archivoBase}_datos.xml");
        ds.WriteXmlSchema($"{archivoBase}_esquema.xsd");
    }

    // Importar desde XML
    public DataSet ImportarDatos(string archivo)
    {
        DataSet ds = new DataSet();
        ds.ReadXml(archivo, XmlReadMode.ReadSchema);
        Console.WriteLine($"Datos importados desde {archivo}");
        return ds;
    }
}</code></pre>

            <h3>Ejemplo de uso</h3>
            <pre><code>class Program
{
    static void Main()
    {
        // Crear DataSet con datos
        DataSet dsUniversidad = new DataSet("Universidad");

        DataTable dtEstudiantes = new DataTable("Estudiantes");
        dtEstudiantes.Columns.Add("Id", typeof(int));
        dtEstudiantes.Columns.Add("Nombre", typeof(string));
        dtEstudiantes.Columns.Add("Promedio", typeof(decimal));

        dtEstudiantes.Rows.Add(1, "Juan P√©rez", 4.2m);

        dsUniversidad.Tables.Add(dtEstudiantes);

        // Exportar
        var helper = new DataSetXmlHelper();
        helper.ExportarDatos(dsUniversidad, "universidad.xml");

        // Importar
        DataSet dsImportado = helper.ImportarDatos("universidad.xml");
        Console.WriteLine($"Tablas importadas: {dsImportado.Tables.Count}");
        Console.WriteLine($"Filas: {dsImportado.Tables[0].Rows.Count}");
    }
}</code></pre>

            <h3>Archivo XML generado</h3>
            <pre><code>&lt;?xml version="1.0" standalone="yes"?&gt;
&lt;Universidad&gt;
  &lt;xs:schema id="Universidad" xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;
    &lt;xs:element name="Universidad" msdata:IsDataSet="true"&gt;
      &lt;xs:complexType&gt;
        &lt;xs:choice minOccurs="0" maxOccurs="unbounded"&gt;
        &lt;xs:element name="Estudiantes"&gt;
          &lt;xs:complexType&gt;
            &lt;xs:sequence&gt;
              &lt;xs:element name="Id" type="xs:int" /&gt;
              &lt;xs:element name="Nombre" type="xs:string" /&gt;
              &lt;xs:element name="Promedio" type="xs:decimal" /&gt;
            &lt;/xs:sequence&gt;
          &lt;/xs:complexType&gt;
        &lt;/xs:element&gt;
      &lt;/xs:choice&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;
  &lt;/xs:schema&gt;
  &lt;Estudiantes&gt;
    &lt;Id&gt;1&lt;/Id&gt;
    &lt;Nombre&gt;Juan P√©rez&lt;/Nombre&gt;
    &lt;Promedio&gt;4.2&lt;/Promedio&gt;
  &lt;/Estudiantes&gt;
  &lt;Estudiantes&gt;
    &lt;Id&gt;2&lt;/Id&gt;
    &lt;Nombre&gt;Mar√≠a Garc√≠a&lt;/Nombre&gt;
    &lt;Promedio&gt;4.5&lt;/Promedio&gt;
  &lt;/Estudiantes&gt;
&lt;/Universidad&gt;</code></pre>

            <h3>DataBinding con ADO.NET</h3>
            <pre><code>public partial class frmEstudiantes : Form
{
    private BindingSource bindingSource;
    private DataSet dsEstudiantes;
    private SqlDataAdapter dataAdapter;

    public frmEstudiantes()
    {
        InitializeComponent();
        ConfigurarDataBinding();
        CargarDatos();
    }

    private void ConfigurarDataBinding()
    {
        bindingSource = new BindingSource();

        // Binding bidireccional
        txtNombre.DataBindings.Add("Text", bindingSource, "Nombre", true,
            DataSourceUpdateMode.OnPropertyChanged);
        txtApellido.DataBindings.Add("Text", bindingSource, "Apellido", true,
            DataSourceUpdateMode.OnPropertyChanged);
        txtEmail.DataBindings.Add("Text", bindingSource, "Email", true,
            DataSourceUpdateMode.OnPropertyChanged);

        // DataGridView
        dgvEstudiantes.DataSource = bindingSource;
    }

    private void CargarDatos()
    {
        string connectionString = ConfigurationManager.ConnectionStrings["UniversidadDB"].ConnectionString;

        dsEstudiantes = new DataSet();

        using (var connection = new SqlConnection(connectionString))
        {
            dataAdapter = new SqlDataAdapter("SELECT * FROM Estudiantes", connection);

            // Comandos autom√°ticos para INSERT, UPDATE, DELETE
            var commandBuilder = new SqlCommandBuilder(dataAdapter);

            dataAdapter.Fill(dsEstudiantes, "Estudiantes");
        }

        bindingSource.DataSource = dsEstudiantes.Tables["Estudiantes"];
    }

    private void btnGuardar_Click(object sender, EventArgs e)
    {
        try
        {
            if (dsEstudiantes.HasChanges())
            {
                dataAdapter.Update(dsEstudiantes, "Estudiantes");
                dsEstudiantes.AcceptChanges();

                MessageBox.Show("Cambios guardados exitosamente", "√âxito",
                    MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
        }
        catch (DBConcurrencyException ex)
        {
            MessageBox.Show("Conflicto de concurrencia. Otro usuario modific√≥ los datos.",
                "Error", MessageBoxButtons.OK, MessageBoxIcon.Error);
            CargarDatos();
        }
        catch (Exception ex)
        {
            MessageBox.Show($"Error al guardar: {ex.Message}", "Error",
                MessageBoxButtons.OK, MessageBoxIcon.Error);
        }
    }

    private void btnExportarXML_Click(object sender, EventArgs e)
    {
        using (var saveDialog = new SaveFileDialog())
        {
            saveDialog.Filter = "XML Files|*.xml";
            saveDialog.Title = "Exportar Estudiantes a XML";
            saveDialog.FileName = $"estudiantes_{DateTime.Now:yyyyMMdd}.xml";

            if (saveDialog.ShowDialog() == DialogResult.OK)
            {
                dsEstudiantes.Tables["Estudiantes"].WriteXml(saveDialog.FileName, XmlWriteMode.WriteSchema);
                MessageBox.Show("Exportaci√≥n exitosa", "√âxito",
                    MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
        }
    }
}</code></pre>
        </section>

        <section class="evaluacion-calificable">
            <h3>üìã Evaluaci√≥n programada</h3>
            <p><strong>Detalle:</strong> Consultar plataforma del curso para informaci√≥n completa sobre evaluaci√≥n calificable.</p>
        </section>

        <section id="practica">
            <h2>üõ†Ô∏è Pr√°ctica: Aplicaci√≥n de Gesti√≥n</h2>

            <h3>Crear una app de gesti√≥n de productos</h3>
            <ul>
                <li>DataGridView para listar productos</li>
                <li>TextBoxes para editar producto seleccionado</li>
                <li>Botones para CRUD completo</li>
                <li>Exportar a XML</li>
            </ul>

            <h3>XML Personalizado</h3>
            <p>Crear un serializador XML personalizado con atributos:</p>
            <ul>
                <li><code>[XmlRoot]</code>, <code>[XmlElement]</code>, <code>[XmlAttribute]</code> = Atributos para controlar c√≥mo se serializan clases a XML</li>
                <li><code>[XmlIgnore]</code> para propiedades sensibles</li>
                <li>Exportar/importar objetos complejos</li>
            </ul>

            <p><strong><abbr title="Clase que muestra el di√°logo nativo de Windows para seleccionar d√≥nde guardar un archivo, retornando la ruta seleccionada por el usuario">SaveFileDialog</abbr></strong> = Di√°logo de sistema para guardar archivos.</p>
            <p><strong><abbr title="Clase que proporciona acceso a secciones de configuraci√≥n de aplicaci√≥n como ConnectionStrings y AppSettings desde archivo app.config o web.config">ConfigurationManager</abbr></strong> = Acceso a configuraci√≥n de aplicaci√≥n.</p>
            <p><strong><abbr title="Excepci√≥n que ocurre durante Update() cuando otro usuario modific√≥ el registro que intentas actualizar, requiriendo recargar los datos y reintentar">DBConcurrencyException</abbr></strong> = Error de concurrencia cuando m√∫ltiples usuarios editan el mismo registro.</p>

            <h3>Integraci√≥n Completa</h3>
            <p>Aplicaci√≥n con:</p>
            <ul>
                <li>BindingSource + ADO.NET</li>
                <li>Exportar/importar XML</li>
                <li>Navegaci√≥n (MoveFirst, MoveNext, etc.)</li>
                <li>Filtrado en tiempo real</li>
            </ul>
        </section>

        <section id="ejercicios">
            <h2>üìù Ejercicios</h2>
            
            <h3>Ejercicios Propuestos</h3>
            <ol>
                <li><strong>Aplicaci√≥n de Gesti√≥n:</strong> Crear una app de gesti√≥n de productos con DataGridView, TextBoxes y botones CRUD, m√°s exportaci√≥n a XML.</li>
                <li><strong>XML Personalizado:</strong> Implementar serializaci√≥n XML con atributos personalizados.</li>
                <li><strong>Integraci√≥n Completa:</strong> Aplicaci√≥n completa con BindingSource, ADO.NET, XML y navegaci√≥n.</li>
            </ol>
        </section>

        <section id="referencias">
            <h2>üìö Recursos Adicionales</h2>
            
            <h3>Documentaci√≥n oficial</h3>
            <ul>
                <li><a href="https://docs.microsoft.com/en-us/dotnet/framework/winforms/windows-forms-data-binding" target="_blank">Windows Forms Data Binding</a></li>
                <li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.data.dataset.writexml" target="_blank">DataSet.WriteXml Method</a></li>
                <li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.windows.forms.bindingsource" target="_blank">BindingSource Class</a></li>
            </ul>

            <h3>Resumen de Conceptos Clave</h3>
            <table>
                <tr>
                    <th>Tema</th>
                    <th>Descripci√≥n</th>
                </tr>
                <tr>
                    <td>BindingSource</td>
                    <td>Componente intermediario entre datos y controles UI</td>
                </tr>
                <tr>
                    <td>Data Binding</td>
                    <td>Enlace autom√°tico bidireccional de datos</td>
                </tr>
                <tr>
                    <td>DataSet.WriteXml()</td>
                    <td>Exporta datos a formato XML</td>
                </tr>
                <tr>
                    <td>DataSet.ReadXml()</td>
                    <td>Importa datos desde XML</td>
                </tr>
                <tr>
                    <td>SqlDataAdapter</td>
                    <td>Llena DataSet y actualiza BD autom√°ticamente</td>
                </tr>
            </table>
        </section>
    </main>

    <section id="resumen">
      <h2>Resumen de la Clase</h2>
      <ul>
        <li>WinForms es la API original de .NET para aplicaciones de escritorio Windows.</li>
        <li>Form es la ventana principal; Controls (Button, TextBox, Label) son elementos UI.</li>
        <li>Event-driven programming: Click, Load, TextChanged, KeyPress son eventos comunes.</li>
        <li>DataGridView muestra datos tabulares con soporte para edici√≥n, sorting, paging.</li>
        <li>BindingSource conecta datos a controles UI con sincronizaci√≥n bidireccional autom√°tica.</li>
        <li>DataBindings.Add("Text", source, "Property") enlaza propiedades a TextBox, Label, etc.</li>
        <li>MenuStrip, ToolStrip, StatusStrip crean ribbons y barras de herramientas.</li>
        <li>Dialogs (OpenFileDialog, SaveFileDialog, FolderBrowserDialog) para selecci√≥n de archivos.</li>
        <li>Modal dialogs (ShowDialog) bloquean ventana padre hasta cerrar; Modeless (Show) permiten interacci√≥n concurrente.</li>
        <li>DataGridView permite formatos de celda, validaci√≥n de entrada, y manejo de eventos de edici√≥n.</li>
      </ul>
    </section>

    <footer style="background:#1e293b;color:#fff;text-align:center;padding:24px;margin-top:40px;">
        <p><strong>IF0100 - Lenguaje de Programaci√≥n OO II</strong></p>
        <p>UNAULA - Ingenier√≠a Inform√°tica - 2026-I</p>
    </footer>
</body>
</html>